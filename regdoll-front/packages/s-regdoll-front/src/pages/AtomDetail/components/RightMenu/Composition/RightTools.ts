import AtomModel from '/@/threeScene/atomModule/AtomModule';
import { RootState, SCENE_MODULE_COMMIT_PREFIX } from '/@/store';
import { Store } from 'vuex';
import { ref } from 'vue';
import { ADD_OBJECT } from '/@/store/Scene/mutation-types';
/*
 * @Descripttion:
 * @Author: lgldlk
 * @Date: 2021-07-05 22:30:42
 * @Editors: lgldlk
 * @LastEditTime: 2021-07-06 15:32:58
 */
import { CLOSE_LOADING_WINDOW, OPEN_LOADING_WINDOW } from '/@/PROVIDE_KEY'

import { AtomRequest } from '/@/api/AtomRequest'
import { inject } from 'vue'
export default function rightToolModule(store: Store<RootState>) {
  const showAtomChooseWindow = ref<boolean>(false),
    atomArray = ref<Array<AtomVO>>([]),
    chooseAtomEnName = ref<string>("");
  const openLoadingWindow = inject<Function>(OPEN_LOADING_WINDOW),
    closeLoadingWindow = inject<Function>(CLOSE_LOADING_WINDOW)
  const closeAtomChooseWindow = () => {
    setTimeout(() => {
      showAtomChooseWindow.value = false;
    }, 200);
  },
    openAtomChooseWindow = async () => {
      if (atomArray.value.length == 0) {
        let atomListResult = await AtomRequest.reqAtomList();
        if (atomListResult.code == "200") {
          atomArray.value = atomListResult.data;
        }
      }
      showAtomChooseWindow.value = true;
    },
    affirmChooseAtom = () => {
      closeAtomChooseWindow();
      console.log(openLoadingWindow);

      openLoadingWindow && openLoadingWindow();
      if (chooseAtomEnName.value.length > 0) {
        atomArray.value.map((item, i) => {
          if (item.en_name == chooseAtomEnName.value) {
            store?.commit(
              SCENE_MODULE_COMMIT_PREFIX + ADD_OBJECT,
              [new AtomModel(item.quality, item.ele_number, item.en_name, item.ch_name)],
            );
          }
        });
      }
      closeLoadingWindow && closeLoadingWindow();
    };

  const toolsLIst: Array<{
    image: string;
    title: string;
    clickFunc: () => void;
  }> = [

      {
        image: `<svg t="1625530340711" class="icon" viewBox="0 0 1028 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3902" ><path d="M918.372101 734.697681a109.791385 109.791385 0 0 0-56.388047 15.520488l-121.225117-107.770966a181.424409 181.424409 0 0 0-4.591861-194.603048L831.126752 357.338585a110.204652 110.204652 0 1 0-52.806396-51.199245l-94.546408 90.18414A180.460118 180.460118 0 0 0 585.462214 367.34884a182.434618 182.434618 0 0 0-50.510465 7.209221L464.283016 249.797212a144.092583 144.092583 0 1 0-64.286047 35.265488l70.025872 123.980234a182.434618 182.434618 0 0 0-53.219663 73.469768l-197.450002-25.392989a110.204652 110.204652 0 1 0-14.326604 72.229966L404.083725 554.926342a180.322362 180.322362 0 0 0 32.602209 97.668873l-109.332199 104.372989a144.643606 144.643606 0 1 0 50.189036 53.67885l112.776094-107.495455a181.332571 181.332571 0 0 0 200.480629-6.795953l123.980234 110.204652A110.204652 110.204652 0 1 0 918.372101 734.697681z" fill="#BFE9E9" p-id="3903"></path></svg>`,
        title: `添加原子`,
        clickFunc: () => {
          openAtomChooseWindow()
        }
      },
      {
        image: `<svg t="1625530122928" class="icon" viewBox="0 0 1066 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3714" ><path d="M564.096 287.061333c79.573333-4.608 149.888 32 175.914667 109.909334l-45.312 7.168 90.197333 96.256 56.234667-119.381334-50.56 8.021334c-30.421333-105.642667-124.032-162.688-229.76-156.16-14.549333 1.152-26.026667 15.530667-23.594667 31.146666 3.072 13.184 14.293333 23.850667 26.88 23.04zM804.522667 554.666667c26.965333 0 48.810667 18.773333 48.810666 41.813333v172.373333c0 23.04-21.845333 41.813333-48.810666 41.813334h-201.045334c-26.965333 0-48.810667-18.773333-48.810666-41.813334v-172.373333c0-23.04 21.845333-41.813333 48.810666-41.813333z m-567.893334-35.498667l95.104 91.392-48 10.24c23.210667 93.866667 96.938667 132.010667 162.005334 122.922667a27.008 27.008 0 0 1 28.117333 21.674666c3.285333 15.445333-7.466667 30.378667-21.973333 32.298667-99.072 2.688-189.098667-44.885333-217.088-166.656l-48 10.197333 49.834666-122.069333zM802.261333 597.333333h-196.522666c-4.650667 0-8.405333 2.986667-8.405334 6.741334v157.184c0 3.712 3.754667 6.741333 8.405334 6.741333h196.522666c4.650667 0 8.405333-2.986667 8.405334-6.741333v-157.184c0-3.712-3.754667-6.741333-8.405334-6.741334zM420.522667 213.333333c26.965333 0 48.810667 18.773333 48.810666 41.813334v172.373333c0 23.04-21.845333 41.813333-48.810666 41.813333H219.477333C192.512 469.333333 170.666667 450.56 170.666667 427.52V255.146667C170.666667 232.106667 192.512 213.333333 219.477333 213.333333z m-2.261334 42.666667H221.738667C217.088 256 213.333333 258.986667 213.333333 262.741333v157.184c0 3.712 3.754667 6.741333 8.405334 6.741334h196.522666c4.650667 0 8.405333-2.986667 8.405334-6.741334V262.741333C426.666667 258.986667 422.912 256 418.261333 256z" fill="#BFE9E9" p-id="3715"></path></svg>`,
        title: `更换背景`,
        clickFunc: () => {


        }
      },
      {
        image: `<svg t="1625530340711" class="icon" viewBox="0 0 1028 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3902" ><path d="M918.372101 734.697681a109.791385 109.791385 0 0 0-56.388047 15.520488l-121.225117-107.770966a181.424409 181.424409 0 0 0-4.591861-194.603048L831.126752 357.338585a110.204652 110.204652 0 1 0-52.806396-51.199245l-94.546408 90.18414A180.460118 180.460118 0 0 0 585.462214 367.34884a182.434618 182.434618 0 0 0-50.510465 7.209221L464.283016 249.797212a144.092583 144.092583 0 1 0-64.286047 35.265488l70.025872 123.980234a182.434618 182.434618 0 0 0-53.219663 73.469768l-197.450002-25.392989a110.204652 110.204652 0 1 0-14.326604 72.229966L404.083725 554.926342a180.322362 180.322362 0 0 0 32.602209 97.668873l-109.332199 104.372989a144.643606 144.643606 0 1 0 50.189036 53.67885l112.776094-107.495455a181.332571 181.332571 0 0 0 200.480629-6.795953l123.980234 110.204652A110.204652 110.204652 0 1 0 918.372101 734.697681z" fill="#BFE9E9" p-id="3903"></path></svg>`,
        title: `添加原子`,
        clickFunc: () => {

        }
      },
      {
        image: `<svg t="1625530340711" class="icon" viewBox="0 0 1028 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3902" ><path d="M918.372101 734.697681a109.791385 109.791385 0 0 0-56.388047 15.520488l-121.225117-107.770966a181.424409 181.424409 0 0 0-4.591861-194.603048L831.126752 357.338585a110.204652 110.204652 0 1 0-52.806396-51.199245l-94.546408 90.18414A180.460118 180.460118 0 0 0 585.462214 367.34884a182.434618 182.434618 0 0 0-50.510465 7.209221L464.283016 249.797212a144.092583 144.092583 0 1 0-64.286047 35.265488l70.025872 123.980234a182.434618 182.434618 0 0 0-53.219663 73.469768l-197.450002-25.392989a110.204652 110.204652 0 1 0-14.326604 72.229966L404.083725 554.926342a180.322362 180.322362 0 0 0 32.602209 97.668873l-109.332199 104.372989a144.643606 144.643606 0 1 0 50.189036 53.67885l112.776094-107.495455a181.332571 181.332571 0 0 0 200.480629-6.795953l123.980234 110.204652A110.204652 110.204652 0 1 0 918.372101 734.697681z" fill="#BFE9E9" p-id="3903"></path></svg>`,
        title: `添加原子`,
        clickFunc: () => {

        }
      },
      {
        image: `<svg t="1625530340711" class="icon" viewBox="0 0 1028 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3902" ><path d="M918.372101 734.697681a109.791385 109.791385 0 0 0-56.388047 15.520488l-121.225117-107.770966a181.424409 181.424409 0 0 0-4.591861-194.603048L831.126752 357.338585a110.204652 110.204652 0 1 0-52.806396-51.199245l-94.546408 90.18414A180.460118 180.460118 0 0 0 585.462214 367.34884a182.434618 182.434618 0 0 0-50.510465 7.209221L464.283016 249.797212a144.092583 144.092583 0 1 0-64.286047 35.265488l70.025872 123.980234a182.434618 182.434618 0 0 0-53.219663 73.469768l-197.450002-25.392989a110.204652 110.204652 0 1 0-14.326604 72.229966L404.083725 554.926342a180.322362 180.322362 0 0 0 32.602209 97.668873l-109.332199 104.372989a144.643606 144.643606 0 1 0 50.189036 53.67885l112.776094-107.495455a181.332571 181.332571 0 0 0 200.480629-6.795953l123.980234 110.204652A110.204652 110.204652 0 1 0 918.372101 734.697681z" fill="#BFE9E9" p-id="3903"></path></svg>`,
        title: `添加原子`,
        clickFunc: () => {

        }
      }
    ]
  return {
    toolsLIst,
    showAtomChooseWindow,
    closeAtomChooseWindow,
    atomArray,
    chooseAtomEnName,

    affirmChooseAtom
  }
}