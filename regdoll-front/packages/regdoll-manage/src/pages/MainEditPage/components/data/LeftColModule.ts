import { ADD_OBJECT, RENDER_SCENE } from "../../../../store/Scene/mutation-types";
import { Store, useStore } from "vuex";
/*
 * @Descripttion:
 * @Author: lgldlk
 * @Date: 2021-05-04 21:19:22
 * @Editors: lgldlk
 * @LastEditTime: 2021-06-07 21:31:10
 */
import { reactive, ref, provide, inject, readonly } from "vue";
import { leafColumnModuleParts } from "../../data/PROVIDE_KEY";
import { getAtomList } from "/@/api/AtomRequest";
import Atom from "/@/threeScene/Atom";

const partsOption = [
  {
    name: "原子",
    image: `<svg t="1620134840116" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1980"  xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M512 469.333333a42.666667 42.666667 0 1 0 0 85.333334 42.666667 42.666667 0 0 0 0-85.333334z m325.12 42.666667l4.693333-5.973333C899.413333 426.666667 913.066667 353.706667 881.493333 298.666667c-31.573333-55.04-102.4-79.36-198.826666-69.546667h-7.68C636.16 140.8 578.56 85.333333 512 85.333333S387.84 140.8 349.44 230.4L341.333333 229.12C244.906667 219.306667 174.08 243.626667 142.506667 298.666667c-31.573333 55.04-17.92 128 39.68 207.36l4.693333 5.973333-4.693333 5.973333C124.586667 597.333333 110.933333 670.293333 142.506667 725.333333 170.666667 772.266667 224.853333 797.013333 298.666667 797.013333c13.226667 0 26.88 0 42.666666-2.133333h7.68C387.84 883.2 445.44 938.666667 512 938.666667s124.16-55.466667 162.56-145.066667h7.68c14.506667 0 28.16 2.133333 42.666667 2.133333 75.52 0 130.986667-24.746667 157.866666-71.68 31.573333-55.04 17.92-128-39.68-207.36l-5.973333-4.693333zM216.32 341.333333c10.666667-18.773333 42.666667-29.013333 85.333333-29.013333h20.906667a630.613333 630.613333 0 0 0-14.933333 79.786667 640 640 0 0 0-61.866667 53.333333C213.333333 402.773333 203.946667 362.666667 216.32 341.333333z m0 341.333334c-12.373333-21.333333 0-61.44 28.586667-105.386667a640 640 0 0 0 61.866666 53.333333c3.242667 27.008 8.234667 53.802667 14.933334 80.213334-52.906667 3.413333-93.013333-6.826667-105.386667-28.16zM512 170.666667c23.893333 0 52.48 28.16 76.8 78.08a750.933333 750.933333 0 0 0-76.8 26.88 750.933333 750.933333 0 0 0-76.8-26.88C459.52 198.826667 488.106667 170.666667 512 170.666667z m0 682.666666c-23.893333 0-52.48-28.16-76.8-78.08a750.933333 750.933333 0 0 0 76.8-26.88 750.933333 750.933333 0 0 0 76.8 26.88C564.48 825.173333 535.893333 853.333333 512 853.333333z m125.013333-269.226666c-19.626667 13.653333-39.68 26.453333-61.013333 38.826666-21.333333 12.373333-42.666667 23.466667-64 33.28-21.333333-9.941333-42.666667-21.034667-64-33.28-21.333333-12.373333-42.666667-25.173333-61.013333-38.826666C384 561.066667 384 537.173333 384 512c0-25.173333 0-49.066667 2.986667-72.106667 19.626667-13.653333 39.68-26.453333 61.013333-38.826666 21.333333-12.373333 42.666667-23.466667 64-33.28 21.333333 9.941333 42.666667 21.034667 64 33.28 21.333333 12.373333 42.666667 25.173333 61.013333 38.826666 0 23.04 2.986667 46.933333 2.986667 72.106667 0 25.173333 0 49.066667-2.986667 72.106667z m170.666667 98.56c-12.373333 21.333333-52.48 32-105.386667 28.16a637.44 637.44 0 0 0 14.933334-80.213334 640 640 0 0 0 61.866666-53.333333c31.573333 43.946667 40.96 84.053333 28.586667 105.386667z m-28.586667-235.946667a640 640 0 0 0-61.866666-53.333333 630.613333 630.613333 0 0 0-14.933334-79.786667h20.906667c42.666667 0 73.813333 10.24 85.333333 29.013333 11.52 18.773333 2.133333 60.16-29.44 104.106667z" fill="#35495E" p-id="1981">
</path>
</svg>`,
    click: () => {
      openAtomChooseWindow();
    },
  },
  {
    name: "模型",
    image: `<svg t="1623063008873" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3034" ><path d="M526.628571 300.119771v294.473143l254.829715-147.2512V152.897829z" fill="#CEDDFF" p-id="3035"></path><path d="M271.798857 152.897829L526.628571 300.119771v294.473143L271.798857 447.341714z" fill="#1E3465" p-id="3036"></path><path d="M526.628571 305.795657l254.829715-144.413257L526.628571 16.9984 271.798857 161.3824z" fill="#4C84FF" p-id="3037"></path><path d="M271.798857 724.816457V1019.318857L526.628571 872.0384V577.594514z" fill="#CEDDFF" p-id="3038"></path><path d="M16.969143 577.594514l254.829714 147.221943V1019.318857L16.969143 872.0384z" fill="#1E3465" p-id="3039"></path><path d="M271.798857 730.492343L526.628571 586.079086l-254.829714-144.384-254.829714 144.384z" fill="#4C84FF" p-id="3040"></path><path d="M764.459886 724.816457V1019.318857l254.829714-147.2512V577.594514z" fill="#CEDDFF" p-id="3041"></path><path d="M526.628571 577.594514l254.829715 147.221943V1019.318857L526.628571 872.0384z" fill="#1E3465" p-id="3042"></path><path d="M764.459886 730.492343l254.829714-144.413257-254.829714-144.384-254.829715 144.384z" fill="#4C84FF" p-id="3043"></path></svg>`,
    click: () => {
      console.log("atomClick2");
    },
  },
  {
    name: "原子",
    image: `<svg t="1620134840116" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1980"  xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M512 469.333333a42.666667 42.666667 0 1 0 0 85.333334 42.666667 42.666667 0 0 0 0-85.333334z m325.12 42.666667l4.693333-5.973333C899.413333 426.666667 913.066667 353.706667 881.493333 298.666667c-31.573333-55.04-102.4-79.36-198.826666-69.546667h-7.68C636.16 140.8 578.56 85.333333 512 85.333333S387.84 140.8 349.44 230.4L341.333333 229.12C244.906667 219.306667 174.08 243.626667 142.506667 298.666667c-31.573333 55.04-17.92 128 39.68 207.36l4.693333 5.973333-4.693333 5.973333C124.586667 597.333333 110.933333 670.293333 142.506667 725.333333 170.666667 772.266667 224.853333 797.013333 298.666667 797.013333c13.226667 0 26.88 0 42.666666-2.133333h7.68C387.84 883.2 445.44 938.666667 512 938.666667s124.16-55.466667 162.56-145.066667h7.68c14.506667 0 28.16 2.133333 42.666667 2.133333 75.52 0 130.986667-24.746667 157.866666-71.68 31.573333-55.04 17.92-128-39.68-207.36l-5.973333-4.693333zM216.32 341.333333c10.666667-18.773333 42.666667-29.013333 85.333333-29.013333h20.906667a630.613333 630.613333 0 0 0-14.933333 79.786667 640 640 0 0 0-61.866667 53.333333C213.333333 402.773333 203.946667 362.666667 216.32 341.333333z m0 341.333334c-12.373333-21.333333 0-61.44 28.586667-105.386667a640 640 0 0 0 61.866666 53.333333c3.242667 27.008 8.234667 53.802667 14.933334 80.213334-52.906667 3.413333-93.013333-6.826667-105.386667-28.16zM512 170.666667c23.893333 0 52.48 28.16 76.8 78.08a750.933333 750.933333 0 0 0-76.8 26.88 750.933333 750.933333 0 0 0-76.8-26.88C459.52 198.826667 488.106667 170.666667 512 170.666667z m0 682.666666c-23.893333 0-52.48-28.16-76.8-78.08a750.933333 750.933333 0 0 0 76.8-26.88 750.933333 750.933333 0 0 0 76.8 26.88C564.48 825.173333 535.893333 853.333333 512 853.333333z m125.013333-269.226666c-19.626667 13.653333-39.68 26.453333-61.013333 38.826666-21.333333 12.373333-42.666667 23.466667-64 33.28-21.333333-9.941333-42.666667-21.034667-64-33.28-21.333333-12.373333-42.666667-25.173333-61.013333-38.826666C384 561.066667 384 537.173333 384 512c0-25.173333 0-49.066667 2.986667-72.106667 19.626667-13.653333 39.68-26.453333 61.013333-38.826666 21.333333-12.373333 42.666667-23.466667 64-33.28 21.333333 9.941333 42.666667 21.034667 64 33.28 21.333333 12.373333 42.666667 25.173333 61.013333 38.826666 0 23.04 2.986667 46.933333 2.986667 72.106667 0 25.173333 0 49.066667-2.986667 72.106667z m170.666667 98.56c-12.373333 21.333333-52.48 32-105.386667 28.16a637.44 637.44 0 0 0 14.933334-80.213334 640 640 0 0 0 61.866666-53.333333c31.573333 43.946667 40.96 84.053333 28.586667 105.386667z m-28.586667-235.946667a640 640 0 0 0-61.866666-53.333333 630.613333 630.613333 0 0 0-14.933334-79.786667h20.906667c42.666667 0 73.813333 10.24 85.333333 29.013333 11.52 18.773333 2.133333 60.16-29.44 104.106667z" fill="#42526E" p-id="1981">
</path>
</svg>`,
    click: () => {
      console.log("atomClick2");
    },
  },
];
let store: Store<any> | null;
export const getParts = () => inject(leafColumnModuleParts);
const proParts = (): Array<any> => {
  provide(leafColumnModuleParts, partsOption);
  return partsOption;
};
const showAtomChooseWindow = ref<boolean>(false),
  atomArray = ref<Array<AtomVO>>([]),
  chooseAtomEnName = ref<string>("");

const closeAtomChooseWindow = () => {
    setTimeout(() => {
      showAtomChooseWindow.value = false;
    }, 200);
  },
  openAtomChooseWindow = async () => {
    if (atomArray.value.length == 0) {
      let atomListResult = await getAtomList();
      if (atomListResult.code == "200") {
        atomArray.value = atomListResult.data;
      }
    }
    showAtomChooseWindow.value = true;
  },
  affirmChooseAtom = () => {
    if (chooseAtomEnName.value.length > 0) {
      atomArray.value.map((item, i) => {
        if (item.en_name == chooseAtomEnName.value) {
          store?.commit(
            "scene/" + ADD_OBJECT,
            new Atom(item.quality, item.ele_number, item.en_name, item.ch_name),
          );
          store?.commit("scene/" + RENDER_SCENE);
        }
      });
      closeAtomChooseWindow();
    }
  };
export default function leafColMod(storeIn: Store<any>) {
  proParts();
  store = storeIn;
  return {
    showAtomChooseWindow,
    closeAtomChooseWindow,
    affirmChooseAtom,
    atomArray,
    chooseAtomEnName,
  };
}
